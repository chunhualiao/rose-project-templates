## A sample Makefile to build a ROSE tool using an installed copy of ROSE , made using SPACK
##
## Important: remember that Makefile recipes must contain tabs:
##
##     <target>: [ <dependency > ]*
##         [ <TAB> <command> <endl> ]+
## So you have to replace spaces with Tabs if you copy&paste this file from a browser!
 
## ROSE installation contains
##   * libraries, e.g. "librose.la"
##   * headers, e.g. "rose.h"
ROSE_INSTALL=/collab/usr/global/tools/rose/release/.spack/opt/spack/linux-rhel6-x86_64/gcc-4.8.5/rose-0.9.9.52-ydsmdbo5dxj5wlewgjy45vdtkemceaau
BINDIR=$(ROSE_INSTALL)/bin
 
## ROSE uses the BOOST C++ libraries
BOOST_INSTALL=/collab/usr/global/tools/rose/release/.spack/opt/spack/linux-rhel6-x86_64/gcc-4.8.5/boost-1.56.0-bai4om2ywoa7ud7ecmzddlbi35oqyss6
 
## Your translator
TRANSLATOR=rajaChecker
TRANSLATOR_VERSION=-2017.06.19
TRANSLATOR_EXE=$(TRANSLATOR)$(TRANSLATOR_VERSION)
TRANSLATOR_SOURCE=$(TRANSLATOR).C
 
## Input testcode for your translator
TESTCODE=hello.cpp
 
#BOOST_LIBS
# the Sawyer lib uses a long list of boost libs
BOOST_LIBS=-lboost_date_time -lboost_thread -lboost_filesystem -lboost_program_options -lboost_regex -lboost_system -lboost_serialization -lboost_wave -lboost_iostreams
LINK_FLAGS=-Wl,-rpath=$(ROSE_INSTALL)/lib -L$(ROSE_INSTALL)/lib -lrose -pthread -Wl,-rpath=$(BOOST_INSTALL)/lib -L$(BOOST_INSTALL)/lib $(BOOST_LIBS) -lm
# #-------------------------------------------------------------
# # Makefile Targets
# #-------------------------------------------------------------
 
all: $(TRANSLATOR_EXE)
 
# # compile the translator and generate an executable
# # -g is recommended to be used by default to enable debugging your code
# # Note: depending on the version of boost, you may have to use something like -I $(BOOST_ROOT)/include/boost-1_40 instead.
$(TRANSLATOR_EXE): $(TRANSLATOR_SOURCE)
	g++ -g $(TRANSLATOR_SOURCE) -I$(BOOST_INSTALL)/include -I$(ROSE_INSTALL)/include/rose $(LINK_FLAGS) -o $(TRANSLATOR_EXE)
 
# test the translator
check: $(TRANSLATOR_EXE)
	./$(TRANSLATOR_EXE) -c -I. -I$(ROSE_INSTALL)/include $(TESTCODE)
 
clean:
	rm -rf $(TRANSLATOR_EXE) *.o rose_* *.dot
 
.PHONY: install
install: $(TRANSLATOR_EXE)
	install -m 755 $(TRANSLATOR_EXE) $(BINDIR)

